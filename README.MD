# PTZ Synthetic Camera POC

This is a minimal proof-of-concept project for creating a **synthetic pan-tilt-zoom (PTZ) camera rig** that can be controlled manually over a video. The goal is to collect training data compatible with **LeRobot/SmolVLA** (using a dataset structure similar to `lerobot/pusht`).

---

## Overview

* Load a source video.
* Display it in a window.
* Use **WASD** to tilt/pan and the **mouse wheel** to zoom.
* The viewport acts as a *virtual camera*.
* All user inputs and viewport states are logged frame-by-frame.
* Data is saved directly in a LeRobot-compatible format:

  * MP4 video for `observation.image`
  * Parquet for frame metadata (`observation.state`, `action`, etc.)
  * `meta/info.json` for dataset description

---

## Controls

| Key         | Action                            |
| ----------- | --------------------------------- |
| W / S       | Tilt up / down                    |
| A / D       | Pan left / right                  |
| Mouse Wheel | Zoom in / out                     |
| Space       | Start / stop recording an episode |
| Esc         | Quit application                  |

---

## Requirements

```
pygame-ce
av
numpy
opencv-python
pyarrow
imageio
imageio-ffmpeg
```

Install dependencies:

```
pip install -r requirements.txt
```

---

## Running

```
python main.py --video path/to/input.mp4 --out_dir dataset_out --size 256 --fps 24
```

Then control the viewport using the keys above. When done, press **Space** to finish the episode and **Esc** to exit.

---

## Output Structure

```
dataset_out/
├── meta/info.json
├── data/
│   └── chunk-000/
│       └── episode_000000.parquet
└── videos/
    └── chunk-000/
        └── observation.image/
            └── episode_000000.mp4
```

---

## Next Steps

* Add autofocus (focus/dfocus channel)
* Add multi-task instructions or multiple clips
* Integrate automatic metadata counting

---

**Author:** Generated by Codex for quick POC development
